webpackJsonp([45],{"5UXO":function(e,t){},PBs5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),s=a.n(o),l=a("fZjL"),r=a.n(l),i=a("28Pe"),n=a("+cKO"),u=(a("YA2N"),{name:"RoleMain",data:function(){return{userDataList:[],termForSearch:"",tableDataUrl:"sys/role/rolePageData",currPageNum:1,totalPage:1,showModalPage:!1,showRoleFunction:!1,isEditModal:!1,edit_role_id:"",editFormData:{user_role_id:"",user_role_name:""},addFormData:{term:"",pos:"",freq:"1"},roleFunctionData:[],menuCheckedForRole:[]}},validations:{formData:{user_role_id:{required:n.required},user_role_name:{required:n.required}}},computed:{formData:function(){return this.isEditModal?this.editFormData:this.addFormData},modalPageTitle:function(){return this.isEditModal?"修改角色":"新增角色"}},components:{WorkTablePager:i.a},methods:{getTableData:function(e){e&&""!=e?this.currPageNum=e:e=this.currPageNum;var t=this;this.BaseRequest({url:this.tableDataUrl,method:"get",params:{currPage:e,pageSize:10,search:this.termForSearch||""}}).then(function(e){t.totalPage=e.totalPage,t.refreshTableList(e.dataList)})},refreshTableList:function(e){this.userDataList=e},delRole:function(e){var t=this;this.BaseRequest({url:"sys/role/deleteRole",method:"get",params:{user_role_id:e}}).then(function(e){t.Message.success("删除成功"),t.getTableData()})},openAddModal:function(){this.showModalPage=!0,this.isEditModal=!1},openEditModal:function(e){this.showModalPage=!0,this.isEditModal=!0,this.editFormData=e},closeModal:function(){var e=this;this.showModalPage=!1,this.isEditModal=!1,r()(this.formData).forEach(function(t){e.formData[t]=""})},closeRoleMenus:function(){this.showRoleFunction=!1},openRoleFunction:function(e){this.showRoleFunction=!0;var t=this;this.BaseRequest({url:"sys/roleMenu/getMenuByRole",method:"GET",params:{user_role_id:e}}).then(function(e){t.menuCheckedForRole=[],null!=e&&e.length>0&&e.forEach(function(e){t.menuCheckedForRole.push(e.module_id)})}),this.edit_role_id=e},subWordForm:function(){var e=this;if(!this.checkInputNull()){var t=this.addFormData;this.isEditModal?(t=this.editFormData,this.BaseRequest({url:"sys/role/updateSaveRole",method:"POST",data:t}).then(function(t){e.Message.success("保存成功"),e.getTableData(),e.closeModal()})):this.BaseRequest({url:"sys/role/saveNewRole",method:"post",data:t}).then(function(t){e.Message.success("保存成功"),e.getTableData(),e.closeModal()})}},subRoleMenus:function(){var e=this;this.BaseRequest({url:"sys/roleMenu/saveMenusForRole",method:"post",data:{user_role_id:this.edit_role_id,menus:s()(this.menuCheckedForRole)}}).then(function(t){e.Message.success("保存成功"),e.closeRoleMenus()})},checkInputNull:function(){var e=this.$v.$invalid;return e&&this.$notify({dangerouslyUseHTMLString:!0,message:'<span style="font-size:15px;color:red;font-weight: bold">以下参数不允许为空</span><br>角色编号<br>角色名称'}),e}},mounted:function(){this.userDataList=[],this.getTableData(1);var e=this;this.BaseRequest({url:"sys/menu/listMenuByPage",method:"POST",data:{currPage:"1",pageSize:"200"}}).then(function(t){t.dataList.forEach(function(t){e.roleFunctionData.push({key:t.module_id,label:t.module_name})})})}}),d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-page-root"},[a("el-row",{staticClass:"search-row",attrs:{gutter:20}},[a("el-col",{staticClass:"align-left",attrs:{span:17}},[a("el-button",{attrs:{type:"primary"},on:{click:e.openAddModal}},[e._v("新增")])],1)],1),e._v(" "),a("el-row",{staticClass:"table-row"},[a("el-col",{attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userDataList}},[a("el-table-column",{attrs:{prop:"user_role_id",align:"left",label:"角色ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_role_name",align:"left",label:"角色名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.openRoleFunction(t.row.user_role_id)}}},[e._v("功能")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.openEditModal(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.delRole(t.row.user_role_id)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),a("WorkTablePager",{attrs:{pageCount:e.totalPage},on:{refreshData:e.getTableData}}),e._v(" "),a("el-dialog",{attrs:{title:e.modalPageTitle,visible:e.showModalPage},on:{"update:visible":function(t){e.showModalPage=t}}},[a("el-form",{ref:"editForm",staticClass:"modal-form",attrs:{"label-position":e.left,"label-width":"20%",model:e.formData}},[a("el-form-item",{attrs:{size:e.small,label:"角色编号"}},[a("el-input",{attrs:{disabled:e.isEditModal,"auto-complete":"off"},model:{value:e.formData.user_role_id,callback:function(t){e.$set(e.formData,"user_role_id",t)},expression:"formData.user_role_id"}})],1),e._v(" "),a("el-form-item",{attrs:{size:e.small,label:"角色名称"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formData.user_role_name,callback:function(t){e.$set(e.formData,"user_role_name",t)},expression:"formData.user_role_name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.subWordForm()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"角色功能",visible:e.showRoleFunction},on:{"update:visible":function(t){e.showRoleFunction=t}}},[a("el-transfer",{staticClass:"role-transfer",attrs:{titles:["未选功能","已选功能"],data:e.roleFunctionData},model:{value:e.menuCheckedForRole,callback:function(t){e.menuCheckedForRole=t},expression:"menuCheckedForRole"}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeRoleMenus}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.subRoleMenus()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(u,d,!1,function(e){a("5UXO")},"data-v-23e80bd5",null);t.default=c.exports}});
//# sourceMappingURL=45.bb5e15056e3060c05e3b.js.map