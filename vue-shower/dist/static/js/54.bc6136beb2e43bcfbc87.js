webpackJsonp([54],{E04q:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("fZjL"),o=a.n(s),l=a("28Pe"),r=a("+cKO"),i={name:"UserMain",data:function(){return{userDataList:[],termForSearch:"",tableDataUrl:"sys/user/listUserPage",currPageNum:1,totalPage:1,showModalPage:!1,isEditModal:!1,showUserAuth:!1,allRoleList:[],user_role_id:"",editFormData:{user_id:"",user_name:""},addFormData:{term:"",pos:"",freq:"1"}}},validations:{formData:{user_name:{required:r.required}}},computed:{formData:function(){return this.isEditModal?this.editFormData:this.addFormData},modalPageTitle:function(){return this.isEditModal?"修改用户":"新增词条"}},components:{WorkTablePager:l.a},methods:{getTableData:function(e){e&&""!=e?this.currPageNum=e:e=this.currPageNum;var t=this;this.BaseRequest({url:this.tableDataUrl,method:"get",params:{currPage:e,pageSize:10,search:this.termForSearch||""}}).then(function(e){t.totalPage=e.totalPage,t.refreshTableList(e.dataList)})},refreshTableList:function(e){this.userDataList=e},delWord:function(e){var t=this;this.BaseRequest({url:"manage/dict",method:"delete",data:Qs.stringify({term:e})}).then(function(e){t.Message.success("删除成功"),t.getTableData()})},openAddModal:function(){this.showModalPage=!0,this.isEditModal=!1},openEditModal:function(e){this.showModalPage=!0,this.isEditModal=!0,this.editFormData=e},saveUserRole:function(){var e=this;this.BaseRequest({url:"sys/userRole/updateUserRole",method:"get",params:{user_id:this.editFormData.user_id,user_role_id:this.user_role_id,old_user_role_id:this.editFormData.user_role_id}}).then(function(t){e.Message.success("保存成功"),e.showUserAuth=!1})},openAuthModal:function(e){var t=this;this.showUserAuth=!0,this.editFormData=e,this.BaseRequest({url:"sys/userRole/getRoleByUserId",method:"get",params:{user_id:this.editFormData.user_id}}).then(function(e){null!=e&&e.length>0&&(t.user_role_id=e[0].user_role_id,t.editFormData.user_role_id=e[0].user_role_id)})},closeModal:function(){var e=this;this.showModalPage=!1,this.isEditModal=!1,o()(this.formData).forEach(function(t){e.formData[t]=""})},closeUserAuthModal:function(){this.showUserAuth=!1},subWordForm:function(){var e=this;if(!this.checkInputNull()){var t=this.addFormData,a="sys/user/updateSaveUser";this.isEditModal?(t=this.editFormData,this.BaseRequest({url:a,method:"POST",data:{user_name:t.user_name,user_id:t.user_id}}).then(function(t){e.Message.success("保存成功"),e.getTableData(),e.closeModal()})):this.BaseRequest({url:a,method:"post",data:{user_name:t.user_name,user_id:t.user_id}}).then(function(t){e.Message.success("保存成功"),e.getTableData()})}},checkInputNull:function(){var e=this.$v.$invalid;return e&&this.$notify({dangerouslyUseHTMLString:!0,message:'<span style="font-size:15px;color:red;font-weight: bold">以下参数不允许为空</span><br>用户名称'}),e}},mounted:function(){this.userDataList=[],this.getTableData(1);var e=this;this.BaseRequest({url:"sys/role/rolePageData",method:"get",params:{currPage:1,pageSize:100}}).then(function(t){e.allRoleList=t.dataList})}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-page-root"},[a("el-row",{staticClass:"table-row"},[a("el-col",{attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userDataList}},[a("el-table-column",{attrs:{prop:"user_id",align:"left",label:"用户ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_name",align:"left",label:"用户名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"reg_date",align:"left",label:"首次登入日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"last_login_time",align:"left",label:"最后登入日期"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.openEditModal(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.openAuthModal(t.row)}}},[e._v("权限")])]}}])})],1)],1)],1),e._v(" "),a("WorkTablePager",{attrs:{pageCount:e.totalPage},on:{refreshData:e.getTableData}}),e._v(" "),a("el-dialog",{attrs:{title:e.modalPageTitle,visible:e.showModalPage},on:{"update:visible":function(t){e.showModalPage=t}}},[a("el-form",{ref:"editForm",staticClass:"modal-form",attrs:{"label-position":e.left,"label-width":"20%",model:e.formData}},[a("el-form-item",{attrs:{size:e.small,label:"用户名称"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formData.user_name,callback:function(t){e.$set(e.formData,"user_name",t)},expression:"formData.user_name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.subWordForm()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"用户权限",visible:e.showUserAuth},on:{"update:visible":function(t){e.showUserAuth=t}}},[a("el-form",{ref:"editForm",staticClass:"modal-form",attrs:{"label-position":e.left,"label-width":"20%",model:e.formData}},[a("el-form-item",{attrs:{size:e.small,label:"用户名称"}},[a("el-input",{attrs:{disabled:!0,value:e.editFormData.user_name,"auto-complete":"off"}})],1),e._v(" "),a("el-form-item",{attrs:{size:e.small,label:"角色"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色"},model:{value:e.user_role_id,callback:function(t){e.user_role_id=t},expression:"user_role_id"}},e._l(e.allRoleList,function(e){return a("el-option",{key:e.user_role_id,attrs:{label:e.user_role_name,value:e.user_role_id}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeUserAuthModal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveUserRole()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(i,n,!1,function(e){a("OVOQ")},"data-v-08b445f4",null);t.default=u.exports},OVOQ:function(e,t){}});
//# sourceMappingURL=54.bc6136beb2e43bcfbc87.js.map